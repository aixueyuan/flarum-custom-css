{"version":3,"file":"forum.js","mappings":"MACA,IAAIA,EAAsB,CCA1BA,EAAyBC,IACxB,IAAIC,EAASD,GAAUA,EAAOE,WAC7B,IAAOF,EAAiB,QACxB,IAAM,EAEP,OADAD,EAAoBI,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,GCLRF,EAAwB,CAACM,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXP,EAAoBS,EAAEF,EAAYC,KAASR,EAAoBS,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,MCJ3ER,EAAwB,CAACc,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,I,mBCAlF,MAAM,EAA+BI,OAAOC,KAAKC,OAAO,a,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,iBCAlD,EAA+BF,OAAOC,KAAKC,OAAO,6B,aCKlDC,EAAY,CAChB,cACA,QACA,WACA,cACA,mBACA,UACA,WACA,QACA,gBACA,gBACA,UACA,WACA,YAwCF,SAASC,IACiB,oBAAbC,UAIKA,SAASC,iBAAoC,iCAErDC,QAAQ,SAACC,GACf,IAAMC,EA3CV,SAA2BC,GACzB,IAAKA,GAA0B,oBAAXC,OAClB,OAAO,KAGT,IAAI,IAAAC,EACIC,EACJH,EAAKI,WAAW,YAAcJ,EAAKI,WAAW,YAC1C,IAAIC,IAAIL,GACR,IAAIK,IAAIL,EAAMC,OAAOK,SAASC,QAEpC,GAAIJ,EAAII,SAAWN,OAAOK,SAASC,OACjC,OAAO,KAGT,IAAMC,EAAQL,EAAIM,SAASD,MAAM,4BAEjC,IAAKA,EACH,OAAO,KAGT,IAAME,EAAe,OAAXR,EAAGM,EAAM,IAAEN,EAAI,GAEzB,OAAIQ,GAAiB,MAATA,EACH,MAGTP,EAAIM,SAAW,MAAMD,EAAM,GAAE,eAEtBL,EAAIM,SAAWN,EAAIQ,OAASR,EAAIS,KACzC,CAAE,MAAOC,GACP,OAAO,IACT,CACF,CAUoBC,CAAkBhB,EAAOiB,aAAa,SAElDhB,GACFD,EAAOkB,aAAa,OAAQjB,EAEhC,EACF,CAEA,SAASkB,EAAeC,GACtB,IAAIC,EAtDgB,IAwDpB1B,EAAUI,QAAQ,SAAClB,GACjB,GAAKuC,EAAME,IAAIzC,GAAf,CAIA,IAAM0C,EAAUH,EAAMlC,IAAIL,QAEH,IAAZ0C,IAIXH,EAAMI,IAAI3C,EAAK0C,EAASF,GACxBA,GAAY,GATZ,CAUF,EACF,CAEAI,IAAAA,aAAiBD,IAAI,8BAA+B,YAClDE,EAAAA,EAAAA,QAAOC,IAAAA,UAAoB,WAAYR,GAEf,oBAAbtB,UAA8C,oBAAXM,SAI9CP,IAEI,qBAAsBO,QACP,IAAIyB,iBAAiB,SAACC,GAChBA,EAAUC,KAAK,SAACC,GAAQ,MAAuB,cAAlBA,EAASC,MAAwBD,EAASE,WAAWC,OAAS,CAAC,IAG/G/B,OAAOgC,sBAAsBvC,EAEjC,GAESwC,QAAQvC,SAASwC,KAAM,CAAEC,WAAW,EAAMC,SAAS,IAEhE,E","sources":["webpack://@aixueyuan/flarum-custom-css/webpack/bootstrap","webpack://@aixueyuan/flarum-custom-css/webpack/runtime/compat get default export","webpack://@aixueyuan/flarum-custom-css/webpack/runtime/define property getters","webpack://@aixueyuan/flarum-custom-css/webpack/runtime/hasOwnProperty shorthand","webpack://@aixueyuan/flarum-custom-css/external root \"flarum.core.compat['forum/app']\"","webpack://@aixueyuan/flarum-custom-css/external root \"flarum.core.compat['common/extend']\"","webpack://@aixueyuan/flarum-custom-css/external root \"flarum.core.compat['forum/components/UserPage']\"","webpack://@aixueyuan/flarum-custom-css/./src/forum/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserPage'];","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport type ItemList from 'flarum/common/utils/ItemList';\n\nconst NAV_ORDER = [\n  'discussions',\n  'posts',\n  'recharge',\n  'pay-history',\n  'userMoneyHistory',\n  'uploads',\n  'mentions',\n  'likes',\n  'money-rewards',\n  'ignored-users',\n  'expLogs',\n  'settings',\n  'security',\n];\n\nconst HIGH_PRIORITY = 1000;\n\nfunction transformUserHref(href: string | null): string | null {\n  if (!href || typeof window === 'undefined') {\n    return null;\n  }\n\n  try {\n    const url =\n      href.startsWith('http://') || href.startsWith('https://')\n        ? new URL(href)\n        : new URL(href, window.location.origin);\n\n    if (url.origin !== window.location.origin) {\n      return null;\n    }\n\n    const match = url.pathname.match(/^\\/u\\/([^\\/?#]+)(\\/.*)?$/);\n\n    if (!match) {\n      return null;\n    }\n\n    const rest = match[2] ?? '';\n\n    if (rest && rest !== '/') {\n      return null;\n    }\n\n    url.pathname = `/u/${match[1]}/discussions`;\n\n    return url.pathname + url.search + url.hash;\n  } catch (error) {\n    return null;\n  }\n}\n\nfunction updatePostUserLinks(): void {\n  if (typeof document === 'undefined') {\n    return;\n  }\n\n  const anchors = document.querySelectorAll<HTMLAnchorElement>('.PostUser-name a[href^=\"/u/\"]');\n\n  anchors.forEach((anchor) => {\n    const newHref = transformUserHref(anchor.getAttribute('href'));\n\n    if (newHref) {\n      anchor.setAttribute('href', newHref);\n    }\n  });\n}\n\nfunction reorderUserNav(items: ItemList<unknown>): void {\n  let priority = HIGH_PRIORITY;\n\n  NAV_ORDER.forEach((key) => {\n    if (!items.has(key)) {\n      return;\n    }\n\n    const content = items.get(key);\n\n    if (typeof content === 'undefined') {\n      return;\n    }\n\n    items.add(key, content, priority);\n    priority -= 10;\n  });\n}\n\napp.initializers.add('aixueyuan/flarum-custom-css', () => {\n  extend(UserPage.prototype, 'navItems', reorderUserNav);\n\n  if (typeof document === 'undefined' || typeof window === 'undefined') {\n    return;\n  }\n\n  updatePostUserLinks();\n\n  if ('MutationObserver' in window) {\n    const observer = new MutationObserver((mutations) => {\n      const shouldUpdate = mutations.some((mutation) => mutation.type === 'childList' && mutation.addedNodes.length > 0);\n\n      if (shouldUpdate) {\n        window.requestAnimationFrame(updatePostUserLinks);\n      }\n    });\n\n    observer.observe(document.body, { childList: true, subtree: true });\n  }\n});"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","NAV_ORDER","updatePostUserLinks","document","querySelectorAll","forEach","anchor","newHref","href","window","_match$","url","startsWith","URL","location","origin","match","pathname","rest","search","hash","error","transformUserHref","getAttribute","setAttribute","reorderUserNav","items","priority","has","content","add","app","extend","UserPage","MutationObserver","mutations","some","mutation","type","addedNodes","length","requestAnimationFrame","observe","body","childList","subtree"],"sourceRoot":""}